<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Un instant ‚ú®</title>

<style>
  :root{
    --bg1:#1e293b;
    --bg2:#020617;
    --glass: rgba(255,255,255,0.06);
    --border: rgba(255,255,255,0.12);
    --shadow: 0 22px 70px rgba(0,0,0,0.65);
  }

  body{
    margin:0;
    font-family:-apple-system, system-ui;
    background: radial-gradient(circle at top, var(--bg1), var(--bg2));
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    overflow:hidden;
  }

  .container{
    width:92%;
    max-width:680px;
    background: var(--glass);
    padding:26px;
    border-radius:22px;
    text-align:center;
    box-shadow: var(--shadow);
    backdrop-filter: blur(10px);
    border: 1px solid var(--border);
    position: relative;
  }

  .topbar{
    display:flex;
    justify-content:space-between;
    gap:10px;
    align-items:center;
    margin-bottom:10px;
  }

  .pill{
    display:inline-flex;
    gap:8px;
    align-items:center;
    padding:7px 12px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.16);
    background: rgba(0,0,0,.18);
    font-size:12px;
    opacity:.9;
  }

  .soundBtn{
    padding:8px 12px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.16);
    background: rgba(255,255,255,0.10);
    color:white;
    cursor:pointer;
    font-size:12px;
    transition:.18s;
  }
  .soundBtn:hover{ background: rgba(255,255,255,0.14); transform: translateY(-1px); }

  .title{
    font-size:34px;
    margin: 6px 0 10px;
    min-height:48px;
    text-shadow: 0 0 12px rgba(255,255,255,0.45);
    animation: glow 1.6s ease-in-out infinite alternate;
  }
  @keyframes glow{
    from{ text-shadow: 0 0 10px rgba(255,255,255,0.22); }
    to{ text-shadow: 0 0 22px rgba(255,255,255,0.70); }
  }

  .text{
    line-height:1.75;
    font-size:16px;
    opacity:0;
    transition:opacity .5s;
    white-space:pre-wrap;
    min-height: 140px;
  }

  .hint{
    margin-top: 8px;
    opacity: .72;
    font-size: 12px;
  }

  .grid{
    display:grid;
    gap:10px;
    margin-top:14px;
  }

  button.main{
    width:100%;
    padding:14px 14px;
    border-radius:14px;
    border:none;
    background:white;
    color:black;
    font-size:16px;
    cursor:pointer;
    transition:0.18s;
  }
  button.main:hover{ background:#e2e8f0; transform:scale(1.01); }

  .btnSoft{
    width:100%;
    padding:14px 14px;
    border-radius:14px;
    background: rgba(255,255,255,0.12);
    color:white;
    border: 1px solid rgba(255,255,255,0.18);
    cursor:pointer;
    transition:.18s;
    font-size:16px;
  }
  .btnSoft:hover{ background: rgba(255,255,255,0.16); transform:scale(1.01); }

  .btnGold{
    width:100%;
    padding:14px 14px;
    border-radius:14px;
    background: rgba(251,191,36,0.18);
    color: white;
    border: 1px solid rgba(251,191,36,0.30);
    font-weight: 700;
    cursor:pointer;
    transition:.18s;
    font-size:16px;
  }
  .btnGold:hover{ background: rgba(251,191,36,0.24); transform:scale(1.01); }

  .btnGreen{
    width:100%;
    padding:14px 14px;
    border-radius:14px;
    background: rgba(34,197,94,0.20);
    color: white;
    border: 1px solid rgba(34,197,94,0.35);
    font-weight: 700;
    cursor:pointer;
    transition:.18s;
    font-size:16px;
  }
  .btnGreen:hover{ background: rgba(34,197,94,0.28); transform:scale(1.01); }

  .tiny{ font-size: 12px; opacity: .75; margin-top: 6px; }

  /* Lettre scell√©e */
  .sealWrap{ display:flex; justify-content:center; margin: 10px 0 4px; }
  .envelope{
    width: 230px; height: 145px;
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,0.18);
    background: rgba(0,0,0,0.18);
    position: relative;
    overflow:hidden;
    box-shadow: 0 14px 40px rgba(0,0,0,0.35);
    cursor:pointer;
    transition: transform .18s ease;
  }
  .envelope:hover{ transform: translateY(-1px); }
  .flap{
    position:absolute; inset:0;
    background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
    clip-path: polygon(0 0, 100% 0, 50% 55%);
    transform-origin: top;
    transition: transform .33s ease;
  }
  .paper{
    position:absolute; left: 10px; right: 10px; bottom: 10px;
    height: 115px; border-radius: 14px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.16);
    transform: translateY(64px);
    transition: transform .38s ease;
  }
  .wax{
    position:absolute; left: 50%; top: 64px;
    transform: translateX(-50%);
    width: 48px; height: 48px; border-radius: 999px;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25), rgba(168,85,247,0.38));
    border: 1px solid rgba(255,255,255,0.18);
    display:flex; align-items:center; justify-content:center;
    font-weight: 800; opacity:.95;
  }
  .open .flap{ transform: rotateX(165deg); }
  .open .paper{ transform: translateY(0px); }

  /* ‚Äú3 mots‚Äù */
  .chips{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    justify-content:center;
    margin-top:12px;
  }
  .chip{
    padding:10px 12px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,0.16);
    background: rgba(255,255,255,0.08);
    cursor:pointer;
    font-size:14px;
    transition:.15s;
    user-select:none;
  }
  .chip:hover{ background: rgba(255,255,255,0.12); transform: translateY(-1px); }
  .chip.selected{
    background: rgba(34,197,94,0.18);
    border-color: rgba(34,197,94,0.35);
  }

  /* √©toiles flottantes */
  .star{
    position:absolute;
    color:white;
    animation: float 6s infinite linear;
    opacity:0.12;
    user-select:none;
    pointer-events:none;
  }
  @keyframes float{
    from{ transform:translateY(110vh); }
    to{ transform:translateY(-15vh); }
  }
</style>
</head>

<body>
<div class="container">
  <div class="topbar">
    <div class="pill" id="stagePill">üíå Un instant</div>
    <button class="soundBtn" id="soundBtn">üîä Activer le son</button>
  </div>

  <div class="title" id="title"></div>
  <div class="text" id="text"></div>

  <div id="extra"></div>

  <div class="grid">
    <button class="main" id="btn" style="display:none">Continuer</button>
  </div>

  <div class="hint" id="hint"></div>
</div>

<script>
  // ‚úÖ Personnalisation
  const SON_PRENOM = "Bambi";
  const TON_PRENOM = "Cheikhna";

  const stagePill = document.getElementById("stagePill");
  const titleEl = document.getElementById("title");
  const textEl  = document.getElementById("text");
  const btnEl   = document.getElementById("btn");
  const extraEl = document.getElementById("extra");
  const hintEl  = document.getElementById("hint");
  const soundBtn = document.getElementById("soundBtn");

  let step = 0;
  let ambience = null;   // Douce | Myst√©rieuse | Lumineuse
  let words = [];        // 3 mots choisis

  // --- Mini son (WebAudio) ---
  let audioCtx = null, osc = null, gain = null, isSoundOn = false;

  function startSound(){
    if(isSoundOn) return;
    audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
    osc = audioCtx.createOscillator();
    gain = audioCtx.createGain();
    osc.type = "sine";
    osc.frequency.value = 174; // un peu plus "myst√©rieux"
    gain.gain.value = 0.00001;
    osc.connect(gain); gain.connect(audioCtx.destination);
    osc.start();
    const now = audioCtx.currentTime;
    gain.gain.setValueAtTime(0.00001, now);
    gain.gain.linearRampToValueAtTime(0.02, now + 0.30);
    isSoundOn = true;
    soundBtn.textContent = "üîá Couper le son";
  }
  function stopSound(){
    if(!isSoundOn) return;
    try{
      const now = audioCtx.currentTime;
      gain.gain.setValueAtTime(gain.gain.value, now);
      gain.gain.linearRampToValueAtTime(0.00001, now + 0.22);
      setTimeout(()=>{
        if(osc){ osc.stop(); osc.disconnect(); }
        if(gain){ gain.disconnect(); }
        osc=null; gain=null;
      }, 250);
    }catch(e){}
    isSoundOn=false;
    soundBtn.textContent="üîä Activer le son";
  }
  soundBtn.onclick = async () => {
    if(!isSoundOn){
      startSound();
      if(audioCtx && audioCtx.state === "suspended") await audioCtx.resume();
    } else stopSound();
  };

  function setStage(label){ stagePill.textContent = label; }
  function fadeText(txt){
    textEl.style.opacity = 0;
    setTimeout(()=>{ textEl.textContent = txt; textEl.style.opacity = 1; }, 70);
  }

  function typeFastName(){
    const name = SON_PRENOM + "...";
    titleEl.textContent = "";
    let i = 0;
    (function tick(){
      if(i < name.length){
        titleEl.textContent += name[i++];
        setTimeout(tick, 80);
      } else {
        showStep0();
      }
    })();
  }

  function resetAll(){
    step = 0;
    ambience = null;
    words = [];
    extraEl.innerHTML = "";
    btnEl.style.display = "none";
    typeFastName();
  }

  // --- Po√®me romantique & myst√©rieux avec m√©taphores ---
  function poemFromWords(name, ambience, words){
    const w1 = (words[0] || "douce").toLowerCase();
    const w2 = (words[1] || "vraie").toLowerCase();
    const w3 = (words[2] || "lumi√®re").toLowerCase();

    // on adapte le vocabulaire selon l'ambiance
    if(ambience === "Myst√©rieuse"){
      return `${name},\n\n` +
`Tu es ${w1} comme un secret qu‚Äôon garde au creux de la nuit,\n` +
`${w2} comme un signe qu‚Äôon devine sans le comprendre,\n` +
`et ${w3}‚Ä¶ comme une √©toile qui n‚Äôappara√Æt qu‚Äôaux √¢mes attentives.\n\n` +
`Trois mots,\n` +
`et mon silence devient une lettre.\n` +
`Trois mots,\n` +
`et l‚Äôinstant prend ton parfum.`;
    }

    if(ambience === "Lumineuse"){
      return `${name},\n\n` +
`Tu es ${w1} comme l‚Äôaube qui effleure les toits,\n` +
`${w2} comme un sourire qui √©claire sans bruit,\n` +
`et ${w3}‚Ä¶ comme une chaleur qui reste sur la peau.\n\n` +
`Trois mots,\n` +
`et le monde para√Æt plus tendre.\n` +
`Trois mots,\n` +
`et j‚Äôai envie d‚Äôy croire.`;
    }

    // Douce (par d√©faut)
    return `${name},\n\n` +
`Tu es ${w1} comme une respiration qu‚Äôon retrouve,\n` +
`${w2} comme une pr√©sence qui apaise,\n` +
`et ${w3}‚Ä¶ comme une promesse pos√©e sur les l√®vres.\n\n` +
`Trois mots,\n` +
`et le c≈ìur ralentit.\n` +
`Trois mots,\n` +
`et l‚Äôinstant devient pr√©cieux.`;
  }

  // --- Steps ---
  function showStep0(){
    step = 0;
    setStage("üíå D√©but");
    extraEl.innerHTML = "";
    hintEl.textContent = "Lis doucement. Puis continue.";
    fadeText(
`J‚Äôai pens√© √† toi.

Et j‚Äôai voulu cr√©er ce petit instant.

Pas pour poser des questions,
mais pour que tu ressentes quelque chose de doux ‚Äî
un moment unique, simple‚Ä¶ et inoubliable.

Parce que certains instants,
m√™me silencieux,
peuvent rester.`
    );
    btnEl.style.display = "block";
    btnEl.textContent = "Continuer";
  }

  function showStep1_Ambience(){
    step = 1;
    setStage("üåô Ambiance");
    titleEl.textContent = "Choisis ton ambiance‚Ä¶";
    hintEl.textContent = "Ce choix change la po√©sie.";
    textEl.style.opacity = 1;
    textEl.textContent = "Quelle couleur veux-tu pour cet instant ?";

    extraEl.innerHTML = `
      <div class="grid">
        <button class="btnSoft" data-a="Douce">üåô Douce</button>
        <button class="btnSoft" data-a="Myst√©rieuse">‚ú® Myst√©rieuse</button>
        <button class="btnSoft" data-a="Lumineuse">‚òÄÔ∏è Lumineuse</button>
      </div>
      <div class="tiny">Choisis sans r√©fl√©chir.</div>
    `;

    extraEl.querySelectorAll("[data-a]").forEach(b=>{
      b.onclick = () => {
        ambience = b.getAttribute("data-a");
        if(isSoundOn && osc){
          const f = ambience==="Douce" ? 196 : (ambience==="Myst√©rieuse" ? 174 : 220);
          osc.frequency.setTargetAtTime(f, audioCtx.currentTime, 0.08);
        }
        showStep2_3Words();
      };
    });

    btnEl.style.display = "none";
  }

  function showStep2_3Words(){
    step = 2;
    setStage("üß© 3 mots");
    titleEl.textContent = "Trois mots‚Ä¶";
    hintEl.textContent = "Choisis 3 mots qui te d√©crivent.";
    fadeText(`${SON_PRENOM}, lesquels te ressemblent aujourd‚Äôhui ?`);
    words = [];

    const pool = [
      "Douce","Solaire","Myst√©rieuse","√âl√©gante","Spontan√©e","Calme",
      "Rieuse","Intense","Loyale","Curieuse","Romantique","Audacieuse",
      "Sensible","Sereine","Magn√©tique","Vraie"
    ];

    extraEl.innerHTML = `
      <div class="chips" id="chips"></div>
      <div class="tiny" id="count">0 / 3 s√©lectionn√©s</div>
    `;

    const chips = document.getElementById("chips");
    const count = document.getElementById("count");
    chips.innerHTML = pool.map(w => `<div class="chip" data-w="${w}">${w}</div>`).join("");

    chips.querySelectorAll(".chip").forEach(chip=>{
      chip.onclick = () => {
        const w = chip.getAttribute("data-w");
        const isSel = chip.classList.contains("selected");

        if(isSel){
          chip.classList.remove("selected");
          words = words.filter(x => x !== w);
        } else {
          if(words.length >= 3) return;
          chip.classList.add("selected");
          words.push(w);
        }

        count.textContent = `${words.length} / 3 s√©lectionn√©s`;
        if(words.length === 3){
          btnEl.style.display = "block";
          btnEl.textContent = "Continuer";
        } else {
          btnEl.style.display = "none";
        }
      };
    });

    btnEl.style.display = "none";
  }

  function showStep3_Letter1(){
    step = 3;
    setStage("‚úâÔ∏è Lettre 1");
    titleEl.textContent = "Une lettre pour toi";
    hintEl.textContent = "Clique sur l‚Äôenveloppe.";
    fadeText("J‚Äôai gliss√© une lettre dedans‚Ä¶");

    extraEl.innerHTML = `
      <div class="sealWrap">
        <div class="envelope" id="env1">
          <div class="flap"></div>
          <div class="paper"></div>
          <div class="wax">‚ú¶</div>
        </div>
      </div>
      <div class="tiny">Ouvrir la lettre‚Ä¶</div>
    `;

    document.getElementById("env1").onclick = (e) => {
      e.currentTarget.classList.toggle("open");
      setTimeout(showLetter1Text, 220);
    };

    btnEl.style.display = "none";
  }

  function showLetter1Text(){
    const poem = poemFromWords(SON_PRENOM, ambience, words);
    const w = words.join(", ");

    const letter =
`${poem}\n\n` +
`(Tes trois mots : ${w})\n\n` +
`Je voulais que cet instant soit une trace.\n` +
`Une petite √©nigme douce.\n` +
`Quelque chose qui reste‚Ä¶ m√™me apr√®s l‚Äô√©cran.`;

    fadeText(letter);

    extraEl.innerHTML = `
      <div class="grid">
        <button class="btnGold" id="bonusBtn">Ouvrir une 2·µâ lettre ‚ú®</button>
        <button class="btnGreen" id="replyBtn">Me r√©pondre (copier) üí¨</button>
      </div>
      <div class="tiny">Optionnel : tu peux juste lire.</div>
    `;

    document.getElementById("bonusBtn").onclick = () => showStep3b_Letter2();
    document.getElementById("replyBtn").onclick = async () => {
      await navigator.clipboard.writeText(
        `Je viens de lire ton instant‚Ä¶ c‚Äô√©tait ${ambience.toLowerCase()} et tr√®s beau.\nMes 3 mots : ${words.join(", ")}.\nMerci, √ßa m‚Äôa fait sourire.`
      );
      alert("Copi√© ‚úÖ (tu peux l‚Äôenvoyer)");
    };

    btnEl.style.display = "block";
    btnEl.textContent = "Derni√®re page";
  }

  function showStep3b_Letter2(){
    step = 33;
    setStage("‚úâÔ∏è Lettre 2");
    titleEl.textContent = "Une 2·µâ lettre‚Ä¶";
    hintEl.textContent = "Clique sur l‚Äôenveloppe.";
    fadeText("Encore une page‚Ä¶ plus intime.");

    extraEl.innerHTML = `
      <div class="sealWrap">
        <div class="envelope" id="env2">
          <div class="flap"></div>
          <div class="paper"></div>
          <div class="wax">‚úß</div>
        </div>
      </div>
      <div class="tiny">Ouvrir la 2·µâ lettre‚Ä¶</div>
    `;

    document.getElementById("env2").onclick = (e) => {
      e.currentTarget.classList.toggle("open");
      setTimeout(showLetter2Text, 220);
    };

    btnEl.style.display = "none";
  }

  function showLetter2Text(){
    const w = words.map(x => x.toLowerCase());
    const a = ambience;

    let l2 = "";
    if(a === "Myst√©rieuse"){
      l2 =
`${SON_PRENOM},\n\n` +
`Je ne sais pas pourquoi,\n` +
`mais tes mots (${w.join(", ")})\n` +
`sonnent comme une porte entrouverte.\n\n` +
`Comme si, derri√®re,\n` +
`il y avait une chambre de lumi√®re faible,\n` +
`et une v√©rit√© qu‚Äôon approche doucement.\n\n` +
`Si tu as senti un frisson doux‚Ä¶\n` +
`alors ce moment √©tait vivant.`;
    } else if(a === "Lumineuse"){
      l2 =
`${SON_PRENOM},\n\n` +
`Tes mots (${w.join(", ")})\n` +
`me font penser √† une ville au matin :\n` +
`tout para√Æt possible, sans faire de bruit.\n\n` +
`Garde ce moment.\n` +
`Comme un rayon qui revient\n` +
`quand on ferme les yeux.`;
    } else {
      l2 =
`${SON_PRENOM},\n\n` +
`Tes mots (${w.join(", ")})\n` +
`me font penser √† une main qui rassure :\n` +
`pas besoin d‚Äôexpliquer,\n` +
`juste‚Ä¶ √™tre l√†.\n\n` +
`Si tu pouvais garder une seule sensation,\n` +
`je voudrais que ce soit la paix.`;
    }

    fadeText(l2);

    extraEl.innerHTML = `
      <div class="grid">
        <button class="btnGold" id="keepBtn">Garder ce moment (copier) ‚ú®</button>
        <button class="btnSoft" id="backBtn">Revenir √† la 1 ≥·µâ lettre</button>
      </div>
      <div class="tiny">Tu peux revenir, ou continuer.</div>
    `;

    document.getElementById("keepBtn").onclick = async () => {
      await navigator.clipboard.writeText("Je garde ce moment. C‚Äô√©tait unique ‚ú®");
      alert("Copi√© ‚úÖ");
    };
    document.getElementById("backBtn").onclick = () => showLetter1Text();

    btnEl.style.display = "block";
    btnEl.textContent = "Derni√®re page";
  }

  function showStep4_Final(){
    step = 4;
    setStage("üå∏ Fin");
    titleEl.textContent = "Derni√®re page‚Ä¶";
    hintEl.textContent = "";
    btnEl.style.display = "none";

    const poem = poemFromWords(SON_PRENOM, ambience, words);

    fadeText(
`${poem}\n\n` +
`Ce moment n‚Äôattend rien.\n` +
`Il existe simplement.\n\n` +
`Pour te laisser quelque chose de rare :\n` +
`un instant qui reste‚Ä¶\n` +
`comme un parfum sur une √©charpe.`
    );

    extraEl.innerHTML = `
      <div class="grid">
        <button class="btnGreen" id="replayBtn">Rejouer</button>
      </div>
      <div class="tiny">Rejouer change les mots, l‚Äôambiance‚Ä¶ et la po√©sie.</div>
    `;

    document.getElementById("replayBtn").onclick = () => resetAll();
  }

  // --- Navigation ---
  btnEl.onclick = () => {
    if(step === 0) return showStep1_Ambience();
    if(step === 2) return showStep3_Letter1();
    if(step === 3 || step === 33) return showStep4_Final();
    showStep4_Final();
  };

  // --- stars ---
  const symbols = ["‚ú¶","‚úß","‚ú∫","‚ú∂"];
  for(let k=0; k<12; k++){
    const s = document.createElement("div");
    s.className = "star";
    s.textContent = symbols[Math.floor(Math.random()*symbols.length)];
    s.style.left = Math.random()*100 + "vw";
    s.style.animationDuration = (3 + Math.random()*5) + "s";
    s.style.fontSize = (10 + Math.random()*20) + "px";
    s.style.opacity = (0.07 + Math.random()*0.12).toFixed(2);
    document.body.appendChild(s);
  }

  // start
  typeFastName();
</script>
</body>
</html>
