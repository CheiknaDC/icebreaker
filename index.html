<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Un instant ‚ú®</title>

<style>
  :root{
    --bg1:#070b18;
    --bg2:#0f1730;
    --card: rgba(255,255,255,.075);
    --border: rgba(255,255,255,.14);
    --text: rgba(255,255,255,.92);
    --muted: rgba(255,255,255,.72);
    --shadow: 0 18px 70px rgba(0,0,0,.62);
    --radius: 20px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:-apple-system, system-ui, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background:
      radial-gradient(900px 600px at 18% 10%, rgba(168,85,247,.40), transparent 58%),
      radial-gradient(850px 550px at 85% 18%, rgba(34,197,94,.16), transparent 60%),
      radial-gradient(800px 500px at 55% 90%, rgba(59,130,246,.16), transparent 65%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
  }

  .app{
    min-height:100%;
    padding: calc(18px + env(safe-area-inset-top)) 16px calc(18px + env(safe-area-inset-bottom));
    max-width: 680px;
    margin: 0 auto;
    display:flex;
    flex-direction:column;
    gap: 14px;
  }

  header{
    text-align:center;
    margin-top:8px;
    animation: fadeUp .55s ease both;
  }
  h1{margin:0; font-size:28px; letter-spacing:.2px}
  .sub{margin:6px 0 0; color:var(--muted); font-size:14px}

  .card{
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 18px;
    overflow:hidden;
    animation: fadeUp .55s ease both;
  }

  .pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding: 7px 12px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.16);
    background: rgba(0,0,0,.18);
    color: var(--muted);
    font-size: 12px;
    backdrop-filter: blur(10px);
  }

  .title{
    margin: 14px 0 0;
    font-size: 20px;
    line-height: 1.25;
    text-align:center;
    min-height: 56px;
    display:flex;
    align-items:center;
    justify-content:center;
    animation: fadeIn .35s ease both;
  }

  .poem{
    margin: 10px 0 0;
    color: rgba(255,255,255,.88);
    font-size: 14px;
    line-height: 1.65;
    text-align:center;
    white-space: pre-wrap;
    min-height: 90px;
  }

  .grid{
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
    margin-top: 14px;
  }

  .btn{
    width:100%;
    padding: 14px 12px;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,.16);
    background: rgba(0,0,0,.18);
    color: var(--text);
    font-size: 15px;
    cursor:pointer;
    transition: transform .08s ease, background .2s ease, border-color .2s ease;
    box-shadow: 0 10px 18px rgba(0,0,0,.22);
    text-align:center;
  }
  .btn:hover{ background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.22); }
  .btn:active{ transform: scale(.99); }
  .btn.primary{
    font-weight: 700;
    background: rgba(255,255,255,.18);
    border-color: rgba(255,255,255,.28);
  }

  .btn.soft{
    background: rgba(59,130,246,.14);
    border-color: rgba(59,130,246,.28);
  }

  .btn.gold{
    background: rgba(251,191,36,.14);
    border-color: rgba(251,191,36,.26);
    font-weight: 700;
  }

  .sep{ height:1px; background: rgba(255,255,255,.12); margin: 14px 0; }

  .summary{
    line-height: 1.6;
    font-size: 15px;
    color: rgba(255,255,255,.92);
    white-space: pre-wrap;
    animation: fadeIn .35s ease both;
  }

  .hint{ margin-top: 10px; color: rgba(255,255,255,.72); font-size: 12px; text-align:center; }

  .blink{
    display:inline-block;
    width:10px;
    margin-left:2px;
    opacity:.85;
    animation: blink 1s steps(2, start) infinite;
  }
  @keyframes blink{ to{opacity:0} }
  @keyframes fadeUp{ from{opacity:0; transform: translateY(8px)} to{opacity:1; transform: translateY(0)} }
  @keyframes fadeIn{ from{opacity:0} to{opacity:1} }
</style>
</head>

<body>
<main class="app">
  <header>
    <h1>Un instant ‚ú®</h1>
    <p class="sub">Une petite exp√©rience romantique, juste pour toi.</p>
  </header>

  <section class="card" id="screen"></section>

  <p class="hint">√Ä la fin, tu peux copier un message si tu veux r√©pondre.</p>
</main>

<script>
  // ‚úÖ Personnalisation
  const SON_PRENOM = "Bambi";
  const TON_PRENOM = "Cheikhna";

  const screen = document.getElementById("screen");
  const state = { step: 0, a: {} };

  function esc(s){
    return String(s).replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[m]));
  }

  function typewriter(el, text, speed=18){
    el.innerHTML = "";
    const cursor = document.createElement("span");
    cursor.className = "blink";
    cursor.textContent = "‚ñç";
    let i = 0;
    function tick(){
      el.textContent = text.slice(0, i);
      if(i < text.length){
        i++;
        el.appendChild(cursor);
        setTimeout(tick, speed);
      } else {
        setTimeout(()=>cursor.remove(), 500);
      }
    }
    tick();
  }

  async function copyText(text){
    try{
      await navigator.clipboard.writeText(text);
      alert("Copi√© ‚úÖ");
    } catch(e){
      alert("Copie automatique impossible. S√©lectionne le texte et copie.");
    }
  }

  const steps = [
    { type:"intro", tag:"üíå D√©but" },
    { type:"choice", tag:"üåô Premier choix", key:"ambiance", q:`${SON_PRENOM}, quelle ambiance veux-tu pour cet instant ?`, choices:["Douce & calme", "Myst√©rieuse", "Lumineuse"] },
    { type:"choice", tag:"üé∂ Deuxi√®me choix", key:"musique", q:"Si cet instant avait une musique, ce serait‚Ä¶", choices:["Une playlist lente", "Un rythme l√©ger", "Un silence rassurant"] },
    { type:"choice", tag:"‚ú® Troisi√®me choix", key:"moment", q:"Et maintenant‚Ä¶ tu pr√©f√®res :", choices:["Un compliment", "Une promesse", "Un souvenir imaginaire"] },
    { type:"reveal", tag:"üí´ Surprise" },
    { type:"final", tag:"üå∏ Fin" }
  ];

  function render(){
    const s = steps[state.step];

    // INTRO (Bambi... lettre par lettre + po√®me)
    if(s.type === "intro"){
      screen.innerHTML = `
        <div class="pill">${s.tag}</div>
        <div class="title"><span id="nameLine"></span></div>
        <div class="poem" id="poem"></div>
        <div class="grid">
          <button class="btn primary" id="goBtn" style="opacity:0">Commencer</button>
        </div>
        <div class="hint">Prends 30 secondes. Et lis doucement.</div>
      `;

      const nameLine = document.getElementById("nameLine");
      const poemEl = document.getElementById("poem");

      // ‚ÄúBambi‚Ä¶‚Äù √©crit lettre par lettre
      const nameText = `${SON_PRENOM}...`;
      let i = 0;
      function typeName(){
        if(i < nameText.length){
          nameLine.textContent += nameText[i];
          i++;
          setTimeout(typeName, 170);
        } else {
          // Po√®me ensuite
          typewriter(poemEl,
`J‚Äôai pens√© √† toi.
Alors j‚Äôai cr√©√© un petit instant, rien qu‚Äôici.

Pas une question de rendez-vous.
Juste une parenth√®se‚Ä¶ romantique, interactive,
et (je l‚Äôesp√®re) inoubliable.`,
          20);

          setTimeout(()=>{ document.getElementById("goBtn").style.opacity = "1"; }, 1600);
        }
      }
      typeName();

      document.getElementById("goBtn").onclick = () => { state.step++; render(); };
      return;
    }

    // QUESTIONS (choix)
    if(s.type === "choice"){
      const btns = s.choices.map(c => `<button class="btn" data-v="${esc(c)}">${esc(c)}</button>`).join("");
      screen.innerHTML = `
        <div class="pill">${esc(s.tag)}</div>
        <div class="title">${esc(s.q)}</div>
        <div class="grid">${btns}</div>
        <div class="grid">
          <button class="btn" id="backBtn">Retour</button>
        </div>
      `;
      screen.querySelectorAll("[data-v]").forEach(b=>{
        b.addEventListener("click", ()=>{
          state.a[s.key] = b.getAttribute("data-v");
          state.step++;
          render();
        });
      });
      document.getElementById("backBtn").onclick = () => { state.step = Math.max(0, state.step-1); render(); };
      return;
    }

    // REVEAL (surprise personnalis√©e selon ses choix)
    if(s.type === "reveal"){
      const a = state.a;

      const ambiance = (a.ambiance || "").toLowerCase();
      const musique = (a.musique || "").toLowerCase();
      const moment = a.moment || "";

      let surprise = "";
      if(moment === "Un compliment"){
        surprise =
`Alors voil√†, ${SON_PRENOM}‚Ä¶

Il y a chez toi quelque chose qui attire doucement.
Une pr√©sence qui donne envie d‚Äô√©couter.
Et ce genre de personne‚Ä¶ on ne la croise pas tous les jours.`;
      } else if(moment === "Une promesse"){
        surprise =
`Alors voil√†, ${SON_PRENOM}‚Ä¶

Je te promets une chose :
si un jour tu as besoin d‚Äôun instant calme,
d‚Äôune conversation vraie,
je serai l√† ‚Äî sans bruit, sans pression, juste sinc√®re.`;
      } else {
        surprise =
`Alors voil√†, ${SON_PRENOM}‚Ä¶

Imagine : une lumi√®re ${ambiance || "douce"},
une musique ${musique || "lente"},
et deux voix qui se cherchent sans se presser.

√Ä un moment, tu souris.
Et je me dis : ‚ÄúOui. C‚Äôest exactement ce que je voulais lui offrir.‚Äù`;
      }

      screen.innerHTML = `
        <div class="pill">${esc(s.tag)}</div>
        <div class="title">Respire‚Ä¶ et lis.</div>
        <div class="sep"></div>
        <div class="summary" id="surprise"></div>
        <div class="sep"></div>
        <div class="grid">
          <button class="btn gold" id="nextBtn">Continuer</button>
          <button class="btn" id="backBtn">Retour</button>
        </div>
      `;

      typewriter(document.getElementById("surprise"), surprise, 18);

      document.getElementById("nextBtn").onclick = () => { state.step++; render(); };
      document.getElementById("backBtn").onclick = () => { state.step = Math.max(0, state.step-1); render(); };
      return;
    }

    // FINAL (instant inoubliable + message optionnel √† copier)
    if(s.type === "final"){
      const a = state.a;
      const messagePourToi =
`Bambi,

Merci d‚Äôavoir jou√© le jeu.
Si tu relis tout √ßa plus tard,
j‚Äôaimerais que tu gardes une chose :

Tu m√©rites des instants doux.
Des instants vrais.
Et si un jour tu veux en revivre un‚Ä¶
je saurai en cr√©er un autre, encore plus beau.

‚Äî ${TON_PRENOM}`;

      const whatsapp =
`Bambi‚Ä¶ c‚Äô√©tait vraiment doux ü´∂
Ton instant : ${a.ambiance} / ${a.musique} / ${a.moment}
Je veux en cr√©er un autre pour toi, un jour.

‚Äî ${TON_PRENOM}`;

      screen.innerHTML = `
        <div class="pill">${esc(s.tag)}</div>
        <div class="title">Un instant pour toi ‚ú®</div>
        <div class="sep"></div>
        <div class="summary" id="finalText"></div>
        <div class="sep"></div>
        <div class="grid">
          <button class="btn primary" id="copyBtn">Copier un message (WhatsApp)</button>
          <button class="btn soft" id="copyLetterBtn">Copier la lettre</button>
          <button class="btn" id="restartBtn">Recommencer</button>
        </div>
        <div class="hint">Tu peux juste profiter‚Ä¶ ou r√©pondre si tu veux.</div>
      `;

      typewriter(document.getElementById("finalText"), messagePourToi, 16);

      document.getElementById("copyBtn").onclick = () => copyText(whatsapp);
      document.getElementById("copyLetterBtn").onclick = () => copyText(messagePourToi);
      document.getElementById("restartBtn").onclick = () => { state.step = 0; state.a = {}; render(); };
      return;
    }
  }

  render();
</script>
</body>
</html>
